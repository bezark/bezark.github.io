<!doctype html><html lang=en><head><title>LogSeq P5 Page Word Cloud :: Mind's Eye</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="What I decided to go for though was simply getting a wordcloud into a p5 plugin from my [[Logseq]] page entries. Clicking the graph button creates a word cloud for all times I&amp;rsquo;ve linked to that page. That&amp;rsquo;s really nice because in logseq, essentially anything can be a page, and I have a lot of pages for specific parts of my life:
  [[journal]] entries
  [[Dreams]] for my dream journals"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/pages/logseq-p5-page-word-cloud/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon href=/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="LogSeq P5 Page Word Cloud"><meta property="og:description" content="What I decided to go for though was simply getting a wordcloud into a p5 plugin from my [[Logseq]] page entries. Clicking the graph button creates a word cloud for all times I&amp;rsquo;ve linked to that page. That&amp;rsquo;s really nice because in logseq, essentially anything can be a page, and I have a lot of pages for specific parts of my life:
  [[journal]] entries
  [[Dreams]] for my dream journals"><meta property="og:url" content="/pages/logseq-p5-page-word-cloud/"><meta property="og:site_name" content="Mind's Eye"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-02-21 00:00:00 +0000 UTC"></head><body class=green><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Wander</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/showcase>Showcase</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/showcase>Showcase</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/pages/logseq-p5-page-word-cloud/>LogSeq P5 Page Word Cloud</a></h1><div class=post-meta><span class=post-date>2022-02-21</span></div><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#how-i-did-it>How I did it</a></li></ul></nav></div><div class=post-content><div><p>What I decided to go for though was simply getting a wordcloud into a p5 plugin from my [[Logseq]] page entries. Clicking the graph button creates a word cloud for all times I&rsquo;ve linked to that page. That&rsquo;s really nice because in logseq, essentially anything can be a page, and I have a lot of pages for specific parts of my life:</p><ul><li><p>[[journal]] entries</p></li><li><p>[[Dreams]] for my dream journals</p></li><li><p>emotional concepts like when I&rsquo;m [[hard on myself]]</p></li><li><p>and all sorts of stuff!</p></li></ul><p>Here&rsquo;s the <a href=https://github.com/bezark/p5-logseq-wordcloud>GitHub Repo</a></p><h2 id=how-i-did-it>How I did it<a href=#how-i-did-it class=hanchor arialabel=Anchor>&#8983;</a></h2><ul><li><p>I found this decent example for making a wordcloud in p5 with rita,js</p></li><li><p>[[p5 js]] [[Language analysis]] Examples</p><ul><li><a href=https://editor.p5js.org/fauthereea/sketches/aKByHsRr2>Wordcloud</a></li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>params</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ignoreStopWords</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ignoreCase</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ignorePunctuation</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>counts</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>RiTa</span>.<span style=color:#a6e22e>concordance</span>(<span style=color:#a6e22e>lines</span>.<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#34; &#34;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>params</span>); 
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>total</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>totalValues</span>(<span style=color:#a6e22e>counts</span>);
</span></span></code></pre></div><pre><code>+ The [[logseq]] api is fairly straightforward and allows you to create plugins that are essentially just iframes that can be opened and closed.


  + There's an index.js file with this stuff


    + 
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * User model
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>createModel</span> () {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>openSketch</span> () {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// logseq.App.showMsg(&#39;hello, mind map&#39;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>logseq</span>.<span style=color:#a6e22e>showMainUI</span>()
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>main</span> () {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>logseq</span>.<span style=color:#a6e22e>provideStyle</span>(<span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    @import url(&#34;https://at.alicdn.com/t/font_2409735_lkeod9mm2ej.css&#34;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  `</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>logseq</span>.<span style=color:#a6e22e>setMainUIInlineStyle</span>({
</span></span><span style=display:flex><span>    <span style=color:#75715e>// position: &#39;fixed&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// zIndex: 12,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>logseq</span>.<span style=color:#a6e22e>App</span>.<span style=color:#a6e22e>registerUIItem</span>(<span style=color:#e6db74>&#39;pagebar&#39;</span>, {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;another-open-mind&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>template</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>     &lt;a data-on-click=&#34;openSketch&#34; title=&#34;open sketch&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       &lt;i class=&#34;iconfont icon-icons-mind_map&#34; style=&#34;font-size: 18px; line-height: 1em;&#34;&gt;&lt;/i&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>     &lt;/a&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    `</span>,
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// main ui
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// const root = document.querySelector(&#39;#app&#39;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>btnClose</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>createElement</span>(<span style=color:#e6db74>&#39;button&#39;</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>displaySketch</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>createElement</span>(<span style=color:#e6db74>&#39;div&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// events
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>displaySketch</span>.<span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;sketchey&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// displaySketch.classList.add(&#39;mind-display&#39;, &#39;hidden&#39;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>btnClose</span>.<span style=color:#a6e22e>textContent</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CLOSE&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>btnClose</span>.<span style=color:#a6e22e>classList</span>.<span style=color:#a6e22e>add</span>(<span style=color:#e6db74>&#39;close-btn&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>btnClose</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;click&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>logseq</span>.<span style=color:#a6e22e>hideMainUI</span>()
</span></span><span style=display:flex><span>  }, <span style=color:#66d9ef>false</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  document.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;keydown&#39;</span>, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>e</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>keyCode</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>27</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>logseq</span>.<span style=color:#a6e22e>hideMainUI</span>()
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>noLoop</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, <span style=color:#66d9ef>false</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>logseq</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;ui:visible:changed&#39;</span>, <span style=color:#66d9ef>async</span> ({ <span style=color:#a6e22e>visible</span> }) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>visible</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>displaySketch</span>.<span style=color:#a6e22e>classList</span>.<span style=color:#a6e22e>add</span>(<span style=color:#e6db74>&#39;hidden&#39;</span>)
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>displaySketch</span>.<span style=color:#a6e22e>innerHTML</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>currentPage</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>logseq</span>.<span style=color:#a6e22e>Editor</span>.<span style=color:#a6e22e>getCurrentPage</span>()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>backlinkedBlocks</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>logseq</span>.<span style=color:#a6e22e>DB</span>.<span style=color:#a6e22e>datascriptQuery</span>(<span style=color:#e6db74>`[:find (pull ?b [*])
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    :where
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    [?b :block/path-refs [:block/name &#34;`</span><span style=color:#f92672>+</span><span style=color:#a6e22e>currentPage</span>.<span style=color:#a6e22e>name</span><span style=color:#f92672>+</span><span style=color:#e6db74>`&#34;]]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    [?page :block/original-name ?name]]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e>// console.log(backlinkedBlocks)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>textHonk</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>blocky</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>backlinkedBlocks</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>textHonk</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>blocky</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>content</span>)
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// const blocks = await logseq.Editor.getCurrentPageBlocksTree()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>initSketch</span>(<span style=color:#a6e22e>displaySketch</span>, <span style=color:#a6e22e>btnClose</span>, <span style=color:#a6e22e>textHonk</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// mount to root
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// root.append(displaySketch)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param el
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param btnClose
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param data
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>initSketch</span> (<span style=color:#a6e22e>el</span>, <span style=color:#a6e22e>btnClose</span>, <span style=color:#a6e22e>data</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>p</span>){<span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>p5</span>(<span style=color:#a6e22e>sketch</span>, <span style=color:#e6db74>&#39;sketchey&#39;</span>);}
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>updateWordsToDraw</span>(<span style=color:#a6e22e>data</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>loop</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// let mind = new MindElixir(options)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// mind.init()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>patchRightBottomBar</span> <span style=color:#f92672>=</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// const barWrap = document.querySelector(&#39;toolbar.rb&#39;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// barWrap.appendChild(btnClose)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setTimeout</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>patchRightBottomBar</span>()
</span></span><span style=display:flex><span>    <span style=color:#75715e>// mind.initSide()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// el.classList.remove(&#39;hidden&#39;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }, <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// bootstrap
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>logseq</span>.<span style=color:#a6e22e>ready</span>(<span style=color:#a6e22e>createModel</span>(), <span style=color:#a6e22e>main</span>).<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>)
</span></span></code></pre></div><pre><code>  + And then a sketch.js with this stuff

+ Notably, p5 is in instance mode so it can attach nicely to the div that logseq makes.
</code></pre><ul><li><p>The real tricky part was figuring out how to get logseq to query itself for all the blocks with the correct pages</p><ul><li>The database is built in datomic/datascript and the syntax for that query was</li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>   <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>backlinkedBlocks</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>logseq</span>.<span style=color:#a6e22e>DB</span>.<span style=color:#a6e22e>datascriptQuery</span>(<span style=color:#e6db74>`[:find (pull ?b [*])
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    :where
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    [?b :block/path-refs [:block/name &#34;`</span><span style=color:#f92672>+</span><span style=color:#a6e22e>currentPage</span>.<span style=color:#a6e22e>name</span><span style=color:#f92672>+</span><span style=color:#e6db74>`&#34;]]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    [?page :block/original-name ?name]]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>)
</span></span></code></pre></div><pre><code>  + I don't realllly know how that worked, but it did!
</code></pre><ul><li>There&rsquo;s still some cleaning up to do with it, but I&rsquo;m already finding it a really interesting tool!</li></ul><h1 id=next-steps>Next Steps<a href=#next-steps class=hanchor arialabel=Anchor>&#8983;</a></h1><ul><li><p><a href=https://t.co/vq3ii3p3My>https://t.co/vq3ii3p3My</a></p></li><li><p><a href=https://nearley.js.org/>Nearley</a></p></li></ul></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/pages/john-bezark/><span class=button__icon>←</span>
<span class=button__text>John Bezark</span></a></span>
<span class="button next"><a href=/pages/100-days-of-thesis/><span class=button__text>100 Days of Thesis</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script>
<script src=/assets/prism.js></script></div></body></html>